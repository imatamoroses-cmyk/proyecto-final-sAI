##PROYECTO
CREATE SCHEMA Imatamoros;
SET search_path TO Imatamoros;

CREATE TABLE Imatamoros.cliente (
    id_cliente SERIAL PRIMARY KEY,
    tipo_identificacion VARCHAR(20) NOT NULL,
    identificacion VARCHAR(20) UNIQUE NOT NULL,
    nombre VARCHAR(100) NOT NULL,
    apellido VARCHAR(100) NOT NULL,
    telefono VARCHAR(20),
    email VARCHAR(100),
    direccion VARCHAR(100),
    activo BOOLEAN DEFAULT TRUE,
    creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Imatamoros.empleado (
    id_empleado SERIAL PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    apellido VARCHAR(100) NOT NULL,
    telefono VARCHAR(20),
    especialidad VARCHAR(100),
    activo BOOLEAN DEFAULT TRUE,
    creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Imatamoros.servicio (
    id_servicio SERIAL PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    precio NUMERIC(6,2) NOT NULL,
    duracion_min INT NOT NULL,
    activo BOOLEAN DEFAULT TRUE,
    creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Imatamoros.cita (
    id_cita SERIAL PRIMARY KEY,
    id_cliente INT NOT NULL,
    id_empleado INT NOT NULL,
    fecha DATE NOT NULL,
    hora TIME NOT NULL,
    estado VARCHAR(30),
    creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_cita_cliente FOREIGN KEY (id_cliente)
        REFERENCES Imatamoros.cliente(id_cliente),
    CONSTRAINT fk_cita_empleado FOREIGN KEY (id_empleado)
        REFERENCES Imatamoros.empleado(id_empleado)
);

CREATE TABLE Imatamoros.detalle_cita (
    id_detalle_cita SERIAL PRIMARY KEY,
    id_cita INT NOT NULL,
    id_servicio INT NOT NULL,
    cantidad INT NOT NULL,
    precio NUMERIC(6,2) NOT NULL,
    subtotal NUMERIC(8,2) NOT NULL,
    creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_detalle_cita FOREIGN KEY (id_cita)
        REFERENCES Imatamoros.cita(id_cita),
    CONSTRAINT fk_detalle_servicio FOREIGN KEY (id_servicio)
        REFERENCES Imatamoros.servicio(id_servicio)
);

